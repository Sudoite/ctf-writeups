from gmpy2 import mpz, mul, invert, powmod
import codecs

# openssl prime -generate -bits 512

#p = mpz(5555555555555555555555555555555555555555555555555555701)
p = mpz(147022152443768805054640539349665159705689780282604320097582608183582172726109705490683882093208096057358279001425541574187717364407022706765663971562065865747178452435431838684927046282063051057254632059158053908694976874204621061248370724092118996244493251069999115969851925019313155919204200716624591958963)
#q = mpz(5555555555555555555555555555555555555555555555555555747)
q = mpz(154254890290575741941774646609338556641625144563942041618921254666178842915841851535447699696455200975379216347322953469539144919914830134595107564422288569681821680211412584061888066249444256595220115167211516413530582445179304743494140260133100641759435784624675128537133509605111282940605401116735265625263)
n = mul(p,q)
print("length of n is " + str(len(str(n))))
phi = mul(p-1,q-1)
e = 65537
d = invert(e,phi)
print(p)
print(q)
print(n)
print(e)
print(d)
message = int(codecs.encode(b'text','hex_codec'),16)

#int(codecs.encode(b'text','hex_codec'),16)
print("message = " + str(message))
print(str(powmod(powmod(message,e,n),d,n)))
print("d = " + str(d))